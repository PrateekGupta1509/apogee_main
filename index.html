<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>APOGEE 16</title>
	<script src="js/jquery.min.js"></script>
	<style type="text/css">
		*{
			box-sizing:border-box;
		}

		body,html
		{
			position: absolute;
			top: 0;
			left: 0;
			margin: 0;
			padding: 0;
			width: 100%;
			height: 100%;
			overflow:hidden;
		}

		.fulldiv
		{
			position: absolute;
			top:0;
			left: 0;
			width: 100vw;
			height: 100vh;
		}

		.abs_center
		{
			position: absolute;
			top:0;
			left: 0;
			right: 0;
			bottom: 0;
			margin: auto;
		}

		#events{
			background-color: red;
		}

		#event_top,#event_bottom
		{
			position: absolute;
			left:0;
			right: 0;
			margin: auto;
			width: 20%;
			height: 100px;
			background-color: blue;
			overflow: hidden;
		}
		#event_top{bottom:100%;}
		#event_bottom{top: 100%;}

		#event_left,#event_right
		{
			position: absolute;
			width: 1120px;
			top:0;
			bottom: 0;
			margin: auto;
			height: 140px;
			background-color: yellow;
		}
		#event_left{right:100%;}
		#event_right{left: 100%;}

		#event_prev
		{
			width: 935px;
			height: 550px;
			background-color: black;
			background: url("img/icon/bgs.png");
			/*background-repeat: repeat-x;*/
		    background-size: auto 100%;
		    background-position: 0 0; 
		    -webkit-transition: background-position 500ms ease;
		    transition: background-position 500ms ease;
		}

		#event_left .strip {background-position: 0px 0; }
		#event_right .strip {background-position: -140px 0; }
		.strip{
			background: url("img/icon/strip.png");
			/*background-repeat: repeat-x;*/
		    background-size: auto 100%;
		    height: 100%;
		    position: absolute;
		    -webkit-transition: background-position 500ms ease;
		    transition: background-position 500ms ease;
		    width: 1120px;
		}

		.e_strip{
			position: absolute;
			top:0;
			left:0;
			width: 100%;
		}
		.event_cont{
			width:100%;
			line-height: 50px;
			text-align: center;
		}
		.show_event{
			overflow: hidden;
			color: white;
		}
		.se_head{
			position: relative;
			top: -50px;
			width: 100%;
			opacity: 0;
			font-size: 1em;
			white-space: nowrap;
			text-align: center;
			background-color: rgba(0,0,0,0.5);
			-moz-transition: font-size 350ms ease;
			-webkit-transition: font-size 350ms ease;
		    transition: font-size 350ms ease;
		}
		.se_descr{
			position: absolute;
			top: 100px;
			bottom: 0;
			background-color: rgba(0,0,0,0.5);
			padding: 0 10%;
			opacity: 0;
		}
	</style>

</head>
<body>
	<div id="events" class="fulldiv">
		
		
		<div id="event_prev" class="abs_center">
			<div id="event_top">
				<div class="e_strip">
					<div class="event_cont"></div>
				</div>
			</div>
			<div id="event_bottom">
				<div class="e_strip">
					<div class="event_cont"></div>
				</div>
			</div>
			<div id="event_left">
				<div class="strip"></div>
			</div>
			<div id="event_right">
				<div class="strip"></div>
			</div>
			<div class="show_event abs_center">
				<div class="se_head">Event Name</div>
				<div class="se_descr">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi architecto pariatur excepturi, sequi rerum tempora culpa quas quo ratione, laudantium, doloremque iure ex repudiandae odio recusandae, maiores doloribus. Quo, facilis.</div>
			</div>
		</div>
	</div>

<script type="text/javascript">
var event_data;

var cur_cat = 0,cur_event=0;
var keyallow = true;
function next_strip(){
	if(!keyallow)
	{
		return;
	}
	keyallow = false;
	var c = $('#event_right>.strip').css('background-position');
	$('#event_right>.strip').css('background-position',((parseInt(c)-140) + 'px 0'));
	$('#event_left>.strip').css('background-position',c);
	$('#event_prev').css('background-position',((parseInt($('#event_prev').css('background-position')) - 935)+'px 0'));
	cur_cat++;
	if(cur_cat == event_data.length)
		cur_cat = 0;
	open_category(cur_cat);
	setTimeout(function() {
		keyallow = true;
	}, 550);
}
function prev_strip(){
	if(!keyallow)
	{
		return;
	}
	keyallow = false;
	var c = $('#event_left>.strip').css('background-position');
	$('#event_left>.strip').css('background-position',((parseInt(c)+140) + 'px 0'));
	$('#event_right>.strip').css('background-position',c);
	$('#event_prev').css('background-position',((parseInt($('#event_prev').css('background-position')) + 935)+'px 0'));
	cur_cat--;
	if(cur_cat<0)
		cur_cat = event_data.length - 1;
	open_category(cur_cat);
	setTimeout(function() {
		keyallow = true;
	}, 550);
}
var lh = parseInt($('.event_cont').css('line-height'));
function next_eve(){
	if(!keyallow)
	{
		return;
	}
	keyallow = false;
	$('#event_top>.e_strip').animate({top:(parseInt($('#event_top>.e_strip').css('top')) - lh) + 'px'},500);
	$('#event_bottom>.e_strip').animate({top:(parseInt($('#event_bottom>.e_strip').css('top')) - lh) + 'px'},500);
	$('.show_event>.se_head').animate({'top':'100px','opacity':0},200);
	$('.show_event>.se_head').css('font-size','1em');
	$('.show_event>.se_descr').animate({'top':'300px','opacity':0},200);
	setTimeout(function() {
		$('.show_event>.se_head').html('Changed');
		$('.show_event>.se_descr').html('Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa, reprehenderit laboriosam, aperiam natus deleniti hic voluptate quisquam enim, numquam sint possimus voluptatum! Vitae molestiae numquam, dolores repellat eaque, animi dolorum.');
		$('.show_event>.se_head').css({'top':'-50px'});
		$('.show_event>.se_head').css('opacity','1');
		$('.show_event>.se_head').animate({'top':'25px'},250);
		$('.show_event>.se_head').css('font-size','3em');
		$('.show_event>.se_descr').css('top','100px');
		$('.show_event>.se_descr').animate({'opacity':1},250);
	}, 250);
	setTimeout(function() {
		var tt=parseInt($('#event_top>.e_strip').css('top'))*-1;
		var bt=parseInt($('#event_bottom>.e_strip').css('top'))*-1;
		if(tt > ($('#event_top>.e_strip>.event_cont').length-3)*lh)
		{
			$('#event_top>.e_strip').css('top','-100px');
		}
		if(bt > ($('#event_bottom>.e_strip>.event_cont').length-3)*lh)
		{
			$('#event_bottom>.e_strip').css('top','-100px');
		}
		keyallow = true;
	}, 550);
}
function prev_eve(){
	if(!keyallow)
	{
		return;
	}
	keyallow = false;
	$('#event_top>.e_strip').animate({top:(parseInt($('#event_top>.e_strip').css('top')) + lh) + 'px'},500);
	$('#event_bottom>.e_strip').animate({top:(parseInt($('#event_bottom>.e_strip').css('top')) + lh) + 'px'},500);
	$('.show_event>.se_head').animate({'top':'100px','opacity':0},200);
	$('.show_event>.se_head').css('font-size','1em');
	setTimeout(function() {
		$('.show_event>.se_head').html('Changed');
		$('.show_event>.se_head').css({'top':'-50px'});
		$('.show_event>.se_head').css('opacity','1');
		$('.show_event>.se_head').animate({'top':'25px'},250);
		$('.show_event>.se_head').css('font-size','3em');
	}, 250);
	setTimeout(function() {
		var tt=parseInt($('#event_top>.e_strip').css('top'))*-1;
		var bt=parseInt($('#event_bottom>.e_strip').css('top'))*-1;
		if(tt == 0)
		{
			$('#event_top>.e_strip').css('top',($('#event_top>.e_strip>.event_cont').length-4)*-lh + 'px');
		}
		if(bt == 0)
		{
			$('#event_bottom>.e_strip').css('top',($('#event_bottom>.e_strip>.event_cont').length-4)*-lh + 'px');
		}
		keyallow =true;
	}, 550);
}

$(window).keydown(function(e)
{
    var keycode = e.keyCode || e.which;
    switch(keycode)
    {
    	case 37: 
				prev_strip();
				break;
    	case 38: 
				prev_eve();
    			break;
    	case 39:
				next_strip();
    			break;
    	case 40:
				next_eve();
    			break;
    }
});
$(window).load(function(){
	$('#event_top').click(function(){
		prev_eve();
	});
	$('#event_bottom').click(function(){
		next_eve();
	});
	$('#event_left').click(function(){
		prev_strip();
	});
	$('#event_right').click(function(){
		next_strip();
	});
});
function summaryGet(){
	$.ajax({
		url: "http://bits-apogee.org/2016/events/summary/",
		method: "GET",
		success: function(data){
			event_data = data;
			console.log(data);
			open_category(cur_cat);
		}
	});
}

function open_category(x){
	var data = event_data[x].events,ele="";
	$('#event_top > .e_strip').fadeOut(250);
	$('#event_bottom > .e_strip').fadeOut(250);
	ele += '<div class="event_cont">'+data[data.length-2].name+'</div><div class="event_cont">'+data[data.length-1].name+'</div>'
	for(var i=0;i<data.length;i++){
		ele += '<div class="event_cont">'+data[i].name+'</div>';
	}
	ele += '<div class="event_cont">'+data[0].name+'</div><div class="event_cont">'+data[1].name+'</div>';
	setTimeout(function() {
		$('.e_strip').html(ele);
		$('#event_top>.e_strip').css('top',-lh + 'px');
		$('#event_bottom>.e_strip').css('top',(-lh*4) + 'px');
		$('.e_strip').fadeIn(200);
	}, 300);
}

</script>
</body>
</html>